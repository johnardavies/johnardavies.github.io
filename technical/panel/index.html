 <!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Notes on panel data regression | John&#39;s Site</title>
<meta name="keywords" content="technical">
<meta name="description" content="The Yasuyo building, Shinjuku, March 2025
Introduction
The issue of how to analyse data on repeated observations on the same units over time (i.e. panel data/longitudinal data) occurs frequently. For example, visitors returning to a website, the prices of a group of houses over time, people’s pattern of TV viewing and survey respondents answers to repeated questions on their self-assessed well-being (scored between 1 and 10) to name just a few examples I’ve encountered.">
<meta name="author" content="John Davies">
<link rel="canonical" href="https://johnardavies.github.io/technical/panel/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css" integrity="sha256-1vzSCk&#43;4bvpN&#43;sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://johnardavies.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://johnardavies.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://johnardavies.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://johnardavies.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://johnardavies.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://johnardavies.github.io/technical/panel/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://johnardavies.github.io/technical/panel/">
  <meta property="og:site_name" content="John&#39;s Site">
  <meta property="og:title" content="Notes on panel data regression">
  <meta property="og:description" content="The Yasuyo building, Shinjuku, March 2025
Introduction The issue of how to analyse data on repeated observations on the same units over time (i.e. panel data/longitudinal data) occurs frequently. For example, visitors returning to a website, the prices of a group of houses over time, people’s pattern of TV viewing and survey respondents answers to repeated questions on their self-assessed well-being (scored between 1 and 10) to name just a few examples I’ve encountered.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="technical">
    <meta property="article:published_time" content="2025-12-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-07T00:00:00+00:00">
    <meta property="article:tag" content="Technical">
    <meta property="og:image" content="https://johnardavies.github.io/shinjuku.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://johnardavies.github.io/shinjuku.png">
<meta name="twitter:title" content="Notes on panel data regression">
<meta name="twitter:description" content="The Yasuyo building, Shinjuku, March 2025
Introduction
The issue of how to analyse data on repeated observations on the same units over time (i.e. panel data/longitudinal data) occurs frequently. For example, visitors returning to a website, the prices of a group of houses over time, people’s pattern of TV viewing and survey respondents answers to repeated questions on their self-assessed well-being (scored between 1 and 10) to name just a few examples I’ve encountered.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Technicals",
      "item": "https://johnardavies.github.io/technical/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Notes on panel data regression",
      "item": "https://johnardavies.github.io/technical/panel/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Notes on panel data regression",
  "name": "Notes on panel data regression",
  "description": "The Yasuyo building, Shinjuku, March 2025\nIntroduction The issue of how to analyse data on repeated observations on the same units over time (i.e. panel data/longitudinal data) occurs frequently. For example, visitors returning to a website, the prices of a group of houses over time, people’s pattern of TV viewing and survey respondents answers to repeated questions on their self-assessed well-being (scored between 1 and 10) to name just a few examples I’ve encountered.\n",
  "keywords": [
    "technical"
  ],
  "articleBody": "The Yasuyo building, Shinjuku, March 2025\nIntroduction The issue of how to analyse data on repeated observations on the same units over time (i.e. panel data/longitudinal data) occurs frequently. For example, visitors returning to a website, the prices of a group of houses over time, people’s pattern of TV viewing and survey respondents answers to repeated questions on their self-assessed well-being (scored between 1 and 10) to name just a few examples I’ve encountered.\nThe below are some notes to refresh my knowledge of the basics of the topic. What follows assumes some knowledge of regression and linear algebra. It is based on the treatment of the topic in Davidson \u0026 Mackinnon and Johnston \u0026 DiNardo.\nPanel data and the estimation issues it creates We assume there are T observations over time on m different units. The dependent variable is represented by y an (m x T, 1) vector, the n explanatory variables X are represented by a matrix of dimensions (m x T, n) and we are estimating a vector β of n coefficients. We represent this with a corresponding error term as:\nThe error for unit i at time t consists of a unit specific effect η_i and a time specific unit effect ε_it. The standard Ordinary Least Squares (OLS) estimator for this is: This gives y_hat the predicted value of y for a given X. A geometric interpretation of this is that y_hat is the projection of y onto the space spanned by vectors that are the explanatory variables X. Where y_hat is determined by the vector of coefficients β that minimise the difference (the sum of squared errors) between y and y_hat.\nIf we estimate a regression on panel data using a standard OLS estimator as if we have m x T independent observations, rather than T repeated observations on the same m units, then this creates a series of problems:\n-Biased estimates of the coefficients from omitted variable bias Running a regression, without adjusting for the fact that repeated observations come from the same units, is likely to result in a form of omitted variable bias. This is because there are likely to be unit specific effects that affect the dependent variable which will not be captured by the explanatory variables. If these unit specific effects are correlated with the explanatory variables then this will result in the OLS estimates of their coefficients being biased.\n-Inefficient estimates due to heteroscedasticity of errors Unit specific effects are highly likely to result in heteroscedasticity as each unit in the regression data will probably have a different unit specific errors, resulting in errors being correlated across repeated observations on panel members. This is likely to generate inefficient estimates as in this context OLS is not making optimal use of its inputs: an additional observation on a unit in OLS is given the same weight as observations on a new unit even though the latter conveys more information.\nTwo standard approaches to estimating regressions on panel data to address these are now described:\nFixed effects (which helps remove the bias) Random effects (which helps improve efficiency) In what follows, we sometimes refer to the units as individuals or groups.\n1. Fixed effects: Using the variation in the individual units over time (and removing the cross-sectional variation) to estimate the coefficients In the simplest form of fixed effects estimation we assume that each unit’s identity has a specified effect on the dependent variable which does not vary over time e.g. if y is spending and X is a set of data on personal characteristics then person i will always spend η_i more (or less) depending on who they are.\nOne way to adjust for these effects is by estimating the following equation where X are the explanatory variables, D is a set of dummy variables and η is a vector of individual specific effects which do not vary over time. D is specified by an (m x T, m) matrix of group/individual specific dummies which is 1 for unit i’s data for all time periods, but which is otherwise zero. We do not necessarily need to estimate the regression using dummy variables to control for the fixed effects as there are other ways to adjust for them. A standard approach is to take the dependent variable y and the variables in X and for each unit subtract the mean value for that unit for each variable. This has the benefit of not requiring as large a sample size as is needed to estimate the individual fixed effects.\nTo see why this works we split a general regression’s explanatory variables into two sets X_1 and X_2 (We will later specialise to X_2 being the dummy variables that describe when observations relate to a given unit). This means that we first regress the measured y and the relationship with X_1 and X_2 on the other variables X_2 and obtain as residuals the variation of y and X_1 that can’t be explained by variation in X_2. If we then estimate an OLS regression on this transformed y and X_1 data we can then isolate the effects of the Betas for X_1.\nIn the special case of adjusting for the unit specific effects the X_2 variables are the dummy variables in the matrix D. As the dummy variables are specified at the level of the group/individual i.e. they are 1 for individual/or group i across all time periods then, as shown below, this transformation is equivalent to taking the dependent and explanatory variables and subtracting their unit level means. Where the following properties of M_D are used: A consquence of fixed effects estimation is that there will not be an overall constant term: unit specific constants will be set to zero by subtracting their means as the constant term will be fixed across all time periods so they will not appear in the estimates.\nWe have shown that we can control for individual level specific effects on the estimated coefficients by subtracting the data’s unit level means. This means that only variation relative to an individual’s mean affects the estimate. The level of a unit’s data, its mean, relative to others does not matter. As a result, fixed effects estimators are often referred to as within groups estimators as they are only using the variation within groups. The opposite of this is the between groups estimator which is, for the same sample, a regression on the mean of each variable’s unit level values removing any time variation. As shown in Appendix 1 the OLS estimator is a mixture of within and between group estimates.\nThe benefits of fixed effects estimation\nIn most cases it is highly likely there will be factors that affect the outcome of the dependent variable we are interested in, but which we do not have information on e.g. people may have similar incomes and demographic characteristics, but spend quite different amounts of money on consumption. This could relate to differences in psychology, wealth, education or many other factors. We are though unlikely to have complete information on all the relevant factors. Fixed effects offer us the potential to adjust for these differences even if we do not have information on them.\nAs the errors from the fixed effects estimator are likely to be correlated across the repeated observations on units over time there will though be heteroscedasticity in the errors resulting in fixed effects estimators being less efficient i.e. having a higher variance.\nConceptually, although the ability of fixed effects to remove the time-invariant unit effects is attractive. It is also more sensitive to measurement error in the explanatory variables as it uses the variation over time in the variables which is likely to be more driven by this.\nAnother limitation is that the assumption of time-invariant fixed effects is probably not true in many cases of interest. A standard example of this is estimating the effect of a government training programme on a group of people. It may not be possible to observe data on it, but it is plausible that a factor which makes people want to participate in such a scheme is a change in their circumstances, but this by definition will not be a time-invariant fixed effect.\n2. Random effects: Treating the unit specific effects as random variation and adjusting for the heteroscedasticity with Generalised Least Squares (GLS) In the random effects model we treat the individual level effects as random variables. We therefore estimate a form of GLS which corrects the estimator for the heteroscedasticity caused by correlated errors at the unit level over time. In this instance we make a series of assumptions about the error terms: The variance parameters in the lambda are estimated using the variance of the:\n-within groups regression errors to estimate the unit specific variance\n-between groups regression errors to estimate the variance of errors across units\nIf there is no variation in unit specific effects then the effect is constant across units, lambda collapses to 0 and we revert to a standard OLS estimator. If we have a large enough set of observations over time T then we also converge on OLS as the estimated variation in the unit specific effects tends to 0 with the larger sample. If lambda is 1 then the random effects estimator becomes the between groups estimator, where all variable values at the unit level are set to their unit average in the regression (see Appendix 1).\nIf we estimate OLS on the data after the transformation: Where we have used: Calculating the variance-covariance matrix: The benefits of random effects estimation\nIf we look at the second-term of the expectation of the random effects estimator then we can see that if the unit specific effects are correlated with the explanatory variables the second-term will be non-zero and therefore the GLS estimator biased. However, if this is not the case, the random effects estimator has an attractive property. The fixed effects, between groups and standard OLS estimators can all be generalised to being special cases of an estimator of the form: It can be shown that elements of the GLS variance-covariance matrix are always less than or equal to those of the variance-covariance matrix of the weighted least squares estimator i.e. random effects gives us a minimum variance for this form of estimator.\n3. Choosing between fixed and random effects If the errors of the random effects model are uncorrelated with the explanatory variables then the random effects estimates of the coefficients should be better than a fixed effects approach as they will be unbiased and have lower variance.\nHowever, it also feels very plausible that the unit specific factors which we don’t have data on a) affect the dependent variable and b) will often be correlated with the explanatory variables biasing the coefficients estimated using random effects.\nA standard test to distinguish the two alternatives is the Wu Haussman test which is based on the difference between the vector of estimated coefficients from fixed and random effects estimation and the two corresponding variance-covariance matrices. Where H is distributed as a Chi squared distribution with the degrees of freedom equal to the number of coefficients being estimated. The null hypothesis is that the random effects estimator is right. If we do not reject the null then this implies that there is a no difference between the random effects and the fixed effects estimator, then this is an argument for using the lower variance random effects estimator. However, if fixed effects are substantively different that suggests random effects may be biased and we should use fixed effects instead.\nIf the random effects estimator passes the test, this may indicate it is a better estimator, but it is also consistent with there being insufficient variation in the explanatory variables to distinguish the two types of estimator.\nAppendix 1: The OLS estimator is a mixture of between and within groups estimators Appendix 2: Showing that we can invert the errors variance-covariance matrix ",
  "wordCount" : "1995",
  "inLanguage": "en",
  "image":"https://johnardavies.github.io/shinjuku.png","datePublished": "2025-12-07T00:00:00Z",
  "dateModified": "2025-12-07T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "John Davies"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://johnardavies.github.io/technical/panel/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "John's Site",
    "logo": {
      "@type": "ImageObject",
      "url": "https://johnardavies.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://johnardavies.github.io/" accesskey="h" title="John&#39;s Site (Alt + H)">John&#39;s Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
            <ul id="menu">
           <li>
                <a href="https://johnardavies.github.io/creative_industries" title="creative industries">
                    <span>creative industries</span>
                </a>
            </li>
            <li>
                <a href="https://johnardavies.github.io/other_data_projects" title="other data projects">
                    <span>other data projects</span>
                </a>
            </li>
            <li>
                <a href="https://johnardavies.github.io/talks/" title="talks">
                    <span>talks</span>
                </a>
            </li>
            <li>
                <a href="https://johnardavies.github.io/technical/" title="technical posts">
                    <span>technical posts</span>
                </a>
            </li>
            <li>
                <a href="https://johnardavies.github.io/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://johnardavies.github.io/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Notes on panel data regression
    </h1>
    <div class="post-meta"><span title='2025-12-07 00:00:00 +0000 UTC'>December 7, 2025</span>&nbsp;·&nbsp;John Davies

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="https://johnardavies.github.io/shinjuku.png" alt="">
        
</figure>
  <div class="post-content"><p>The Yasuyo building, Shinjuku, March 2025</p>
<h3 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h3>
<p>The issue of how to analyse data on repeated observations on the same units over time (i.e. panel data/longitudinal data) occurs frequently. For example, visitors returning to a website, the prices of a group of houses over time, people’s pattern of TV viewing and survey respondents answers to repeated questions on their self-assessed well-being (scored between 1 and 10) to name just a few examples I’ve encountered.</p>
<p>The below are some notes to refresh my knowledge of the basics of the topic. What follows assumes some knowledge of regression and linear algebra. It is based on the treatment of the topic in
Davidson &amp; Mackinnon and Johnston &amp; DiNardo.</p>
<h3 id="panel-data-and-the-estimation-issues-it-creates">Panel data and the estimation issues it creates<a hidden class="anchor" aria-hidden="true" href="#panel-data-and-the-estimation-issues-it-creates">#</a></h3>
<p>We assume there are T observations over time on m different units. The dependent variable is represented by y an (m x T, 1) vector, the n explanatory variables X are represented by a matrix of dimensions (m x T, n) and we are estimating a vector β of n coefficients. We represent this with a corresponding error term as:</p>
<p><img alt="panel_1" loading="lazy" src="/panel_1.png"></p>
<p>The error for unit i at time t consists of a unit specific effect η_i and a time specific unit effect ε_it.
<img alt="panel_2" loading="lazy" src="/panel_2.png">
The standard Ordinary Least Squares (OLS) estimator for this is:
<img alt="panel_3" loading="lazy" src="/panel_3.png">
This gives y_hat  the predicted value of y for a given X.
<img alt="panel_4" loading="lazy" src="/panel_4.png">
A geometric interpretation of this is that y_hat is the projection of y onto the space spanned by vectors that are the explanatory variables X. Where y_hat is determined by the vector of coefficients β that minimise the difference (the sum of squared errors) between y and y_hat.</p>
<p>If we estimate a regression on panel data using a standard OLS estimator as if we have m x T independent
observations, rather than T repeated observations on the same m units, then this creates a series of problems:</p>
<p>-<strong>Biased estimates of the coefficients from omitted variable bias</strong> Running a regression, without adjusting for the fact that repeated observations come from the same units, is likely to result in a
form of omitted variable bias. This is because there are likely to be unit specific effects that affect the dependent variable which will not be captured by the explanatory variables. If these unit specific effects are correlated with the explanatory variables then this will result in the OLS estimates of their coefficients being biased.</p>
<p>-<strong>Inefficient estimates due to heteroscedasticity of errors</strong> Unit specific effects are highly likely to result in heteroscedasticity as each unit in the regression data will probably have a different unit specific errors, resulting in errors being correlated across repeated observations on panel members. This is likely to generate inefficient estimates as in this context OLS is not making optimal use of its inputs: an additional observation on a unit in OLS is given the same weight as observations on a new unit even though the latter conveys more information.</p>
<p>Two standard approaches to estimating regressions on panel data to address these are now described:</p>
<ol>
<li><strong>Fixed effects</strong> (which helps remove the bias)</li>
<li><strong>Random effects</strong> (which helps improve efficiency)</li>
</ol>
<p>In what follows, we sometimes refer to the units as individuals or groups.</p>
<h3 id="1-fixed-effects-using-the-variation-in-the-individual-units-over-time-and-removing-the-cross-sectional-variation-to-estimate-the-coefficients">1. Fixed effects: Using the variation in the individual units over time (and removing the cross-sectional variation) to estimate the coefficients<a hidden class="anchor" aria-hidden="true" href="#1-fixed-effects-using-the-variation-in-the-individual-units-over-time-and-removing-the-cross-sectional-variation-to-estimate-the-coefficients">#</a></h3>
<p>In the simplest form of fixed effects estimation we assume that each unit’s identity has a specified effect on the dependent variable which does not vary over time e.g. if y is spending and X is a set
of data on personal characteristics then person i will always spend η_i more (or less) depending on who they are.</p>
<p>One way to adjust for these effects is by estimating the following equation where X are the explanatory variables, D is a set of dummy variables and η
is a vector of individual specific effects which do not vary over time. D is specified by an (m x T, m) matrix of group/individual specific dummies which is 1 for unit i’s data for all time periods, but which is otherwise zero.
<img alt="panel_5" loading="lazy" src="/panel_5.png">
We do not necessarily need to estimate the regression using dummy variables to control for the fixed effects as there are other ways to adjust for them. A standard approach is to take the
dependent variable y and the variables in X and for each unit subtract the mean value for that unit for each variable. This has the benefit of not requiring as large a sample size as is needed
to estimate the individual fixed effects.</p>
<p>To see why this works we split a general regression&rsquo;s explanatory variables into two sets X_1 and X_2 (We will later specialise to X_2 being the dummy variables that
describe when observations relate to a given unit).
<img alt="panel_6" loading="lazy" src="/panel_6.png">
This means that we first regress the measured y and the relationship with X_1 and X_2 on the other variables X_2 and obtain as residuals the variation of y and X_1 that can’t be explained by
variation in X_2.
If we then estimate an OLS regression on this transformed y and X_1 data we can then isolate the effects of the Betas for X_1.</p>
<p>In the special case of adjusting for the unit specific effects the X_2 variables are the dummy variables in the matrix D. As the dummy variables are specified at the level of the group/individual
i.e. they are 1 for individual/or group i across all time periods then, as shown below, this transformation is equivalent to taking the dependent and explanatory variables and subtracting their unit level means.
<img alt="panel_7" loading="lazy" src="/panel_7.png">
Where the following properties of M_D are used:
<img alt="panel_8" loading="lazy" src="/panel_8.png">
A consquence of fixed effects estimation is that there will not be an overall constant term: unit specific constants will be set to zero by subtracting their means as
the constant term will be fixed across all time periods so they will not appear in the estimates.</p>
<p>We have shown that we can control for individual level specific effects on the estimated coefficients by subtracting the data&rsquo;s unit level means. This means that only variation relative to an individual’s mean affects the estimate. The level of a unit’s data, its mean, relative to others does not matter. As a result, fixed
effects estimators are often referred to as within groups estimators as they are only using the variation within groups. The opposite of this is the between groups estimator which is, for the same sample, a regression on the mean of each variable&rsquo;s unit level values removing any time variation. As shown in Appendix 1 the OLS estimator is a mixture of within and between group estimates.</p>
<p><strong>The benefits of fixed effects estimation</strong></p>
<p>In most cases it is highly likely there will be factors that affect the outcome of the dependent variable we are interested in, but which we do not have information on e.g. people may have similar incomes and demographic characteristics, but spend quite different amounts of money on consumption. This could relate to differences in psychology, wealth, education or many other factors. We are though unlikely to have complete information on all the relevant factors. Fixed effects offer us the potential to adjust for these differences even if we do not have information on them.</p>
<p>As the errors from the fixed effects estimator are likely to be correlated across the repeated observations on units over time there will though be heteroscedasticity in the errors resulting in fixed effects estimators being less efficient i.e. having a higher variance.</p>
<p>Conceptually, although the ability of fixed effects to remove the time-invariant unit effects is attractive. It is also more sensitive to measurement error in the explanatory variables as it uses the
variation over time in the variables which is likely to be more driven by this.</p>
<p>Another limitation is that the assumption of time-invariant fixed effects is probably not true in many cases of interest. A standard example of this is estimating the effect of a government
training programme on a group of people. It may not be possible to observe data on it, but it is plausible that a factor which makes
people want to participate in such a scheme is a change in their circumstances, but this by definition will not be a time-invariant fixed effect.</p>
<h3 id="2-random-effects-treating-the-unit-specific-effects-as-random-variation-and-adjusting-for-the-heteroscedasticity-with-generalised-least-squares-gls">2. Random effects: Treating the unit specific effects as random variation and adjusting for the heteroscedasticity with Generalised Least Squares (GLS)<a hidden class="anchor" aria-hidden="true" href="#2-random-effects-treating-the-unit-specific-effects-as-random-variation-and-adjusting-for-the-heteroscedasticity-with-generalised-least-squares-gls">#</a></h3>
<p>In the random effects model we treat the individual level effects as random variables. We therefore estimate a form of GLS which corrects the estimator for the heteroscedasticity caused by correlated errors at the unit level over time. In this instance we make a series of assumptions about the error terms:
<img alt="panel_9" loading="lazy" src="/panel_9.png">
The variance parameters in the lambda are estimated using the variance of the:</p>
<p>-within groups regression errors to estimate the unit specific variance<br>
-between groups regression errors to estimate the variance of errors across units</p>
<p>If there is no variation in unit specific effects then the effect is constant across units, lambda collapses to 0 and we revert to a standard OLS estimator. If we have a large enough set of observations over time T then we also converge on
OLS as the estimated variation in the unit specific effects tends to 0 with the larger sample. If lambda is 1 then the random effects estimator becomes the between groups estimator, where all variable values at the unit level are set to their unit average in the regression (see Appendix 1).</p>
<p>If we estimate OLS on the data after the transformation:
<img alt="panel_10" loading="lazy" src="/panel_10.png"></p>
<p>Where we have used:
<img alt="panel_11" loading="lazy" src="/panel_11.png">
Calculating the variance-covariance matrix:
<img alt="panel_12" loading="lazy" src="/panel_12.png"></p>
<p><strong>The benefits of random effects estimation</strong></p>
<p>If we look at the second-term of the expectation of the random effects estimator then we can see that if the unit specific effects are correlated with the explanatory variables the second-term
will be non-zero and therefore the GLS estimator biased. However, if this is not the case, the random effects estimator has an attractive property. The fixed effects, between
groups and standard OLS estimators can all be generalised to being special cases of an estimator of the form:
<img alt="panel_17" loading="lazy" src="/panel_17.png">
It can be shown that elements of the GLS variance-covariance matrix are always less than or equal to those of the variance-covariance matrix of the weighted least squares estimator i.e. random
effects gives us a minimum variance for this form of estimator.</p>
<h3 id="3-choosing-between-fixed-and-random-effects">3. Choosing between fixed and random effects<a hidden class="anchor" aria-hidden="true" href="#3-choosing-between-fixed-and-random-effects">#</a></h3>
<p>If the errors of the random effects model are uncorrelated with the explanatory variables then the random effects estimates of the coefficients should be better than a fixed effects approach as they will be unbiased and have lower variance.</p>
<p>However, it also feels very plausible that the unit specific factors which we don’t have data on a) affect the dependent variable and b) will often be correlated with the explanatory variables biasing the coefficients estimated using random effects.</p>
<p>A standard test to distinguish the two alternatives is the Wu Haussman test which is based on the difference between the vector of estimated coefficients from fixed and random effects estimation and the two
corresponding variance-covariance matrices.
<img alt="panel_13" loading="lazy" src="/panel_13.png"></p>
<p>Where H is distributed as a Chi squared distribution with the degrees of freedom equal to the number of coefficients being estimated. The null hypothesis is that the random effects estimator is
right. If we do not reject the null then this implies that there is a no difference between the random effects and the fixed effects estimator, then this is an argument for using the lower variance random
effects estimator. However, if fixed effects are substantively different that suggests
random effects may be biased and we should use fixed effects instead.</p>
<p>If the random effects estimator passes the test, this may indicate it is a better estimator, but it is also consistent with there being insufficient variation in the explanatory variables to
distinguish the two types of estimator.</p>
<h3 id="appendix-1-the-ols-estimator-is-a-mixture-of-between-and-within-groups-estimators">Appendix 1: The OLS estimator is a mixture of between and within groups estimators<a hidden class="anchor" aria-hidden="true" href="#appendix-1-the-ols-estimator-is-a-mixture-of-between-and-within-groups-estimators">#</a></h3>
<p><img alt="panel_14" loading="lazy" src="/panel_14.png"></p>
<h3 id="appendix-2-showing-that-we-can-invert-the-errors-variance-covariance-matrix">Appendix 2: Showing that we can invert the errors variance-covariance matrix<a hidden class="anchor" aria-hidden="true" href="#appendix-2-showing-that-we-can-invert-the-errors-variance-covariance-matrix">#</a></h3>
<p><img alt="panel_15" loading="lazy" src="/panel_15.png">
<img alt="panel_16" loading="lazy" src="/panel_16.png"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://johnardavies.github.io/tags/technical/">Technical</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://johnardavies.github.io/">John&#39;s Site</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>


